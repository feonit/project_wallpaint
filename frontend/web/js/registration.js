/*! wallpaint - v0.0.1 - 2013-11-26 */$(function(){function e(){var e=g&&v;return u.each(function(){e=e&&s.call(this)}),e||c.fadeIn().text("Необходимо исправить данные"),e}function t(e){g=!e.answer,e.answer?o.call(d,"engaged"):o.call(d,"ok")}function i(e){v=!e.answer,e.answer?o.call(p,"engaged"):o.call(p,"ok")}function n(e){var e=e||window.event,t=e.target||e.srcElement;$(t).val()||o.call($(t),"source")}function s(){if(h.hasOwnProperty($(this).attr("id")))return h[$(this).attr("id")].test($(this).val());throw Error("no have reqexp for this element")}function o(e){if(!this.jquery)throw Error("jquery pls");var t=$("#"+this.attr("id")+"-messages"),i=t.data(e);t.html(i),t.removeClass("ok check error engaged").addClass(e)}function a(){o.call(this,"check")}function r(){if(!this.jquery)throw Error("jquery pls");switch(console.log("валидация"),this.attr("id")){case"email":s.call(this)?m.emit("searchEmail",{email:this.val()}):o.call(this,"error");break;case"user":s.call(this)?m.emit("searchUser",{user:this.val()}):o.call(this,"error");break;default:s.call(this)?o.call(this,"ok"):o.call(this,"error")}}function l(){a.call($(this)),$(this).delay(500),$(this).queue(function(){$(this).queue().length>1?($(this).clearQueue(),$(this).delay(500),$(this).queue(function(){l.call(this)})):r.call($(this)),$(this).dequeue()})}var h={name:/^[A-Za-zА-Яа-я ]{2,30}$/i,email:/^([a-z0-9_-]+.)*[a-z0-9_-]+@([a-z0-9][a-z0-9-]*[a-z0-9].)+\.[a-z]{2,4}$/i,password:/^[A-Za-zА-Яа-я0-9]{6,30}$/i,user:/^[A-Za-zА-Яа-я0-9]{1,30}$/i},c=$("#answer"),u=$("input"),d=$("#user"),p=$("#email");$("#submit");var f=-1!==location.host.search("localhost")?"127.0.0.1:"+location.port:location.host,m=io.connect(f),g=!1,v=!1;m.on("searchUserAnswer",t),m.on("searchEmailAnswer",i),$.cookie("user")&&(d.val($.cookie("user")),o.call(d,"check"),l.call(d)),$.cookie("email")&&(p.val($.cookie("email")),o.call(p,"check"),l.call(p)),u.each(function(){$(this).one("focus",n),$(this).bind("input",l)}),$("form").bind("submit",e)});